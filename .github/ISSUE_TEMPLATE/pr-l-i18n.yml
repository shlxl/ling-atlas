name: "PR-L å¤šè¯­/i18n"
description: "åœ¨ä¸å½±å“ç°æœ‰ä¸­æ–‡è·¯å¾„çš„å‰æä¸‹ï¼Œæ–°å¢è‹±æ–‡å†…å®¹ä¸è·¯ç”±ï¼ˆ/en/...ï¼‰ï¼›å¤šè¯­ Pagefind ç´¢å¼•ä¸åŒä¸€è¯­ä¹‰æ¨¡å‹ï¼ˆgte-smallï¼‰"
title: "[PR-L] å¤šè¯­/i18nï¼ˆ/ ä¸ /en/ï¼‰"
labels: ["i18n", "routing", "search", "content-ops"]

body:
  - type: markdown
    attributes:
      value: |
        ## ğŸ¯ ç›®æ ‡ä¸çº¦æŸ
        - **ä¸­æ–‡ä¿æŒåŸç»“æ„**ï¼›è‹±æ–‡å†…å®¹æ”¾ `docs/content.en/**`ï¼Œå¯¹åº”è·¯ç”±å‰ç¼€ **`/en/`**ã€‚
        - **çº¯é™æ€å®ç°**ï¼›ä¸æ”¹å˜ä¸­æ–‡ç°æœ‰ URLã€‚
        - Pagefind ä¸º zh / en **åˆ†åˆ«å»ºç´¢å¼•**ï¼›è¯­ä¹‰æ£€ç´¢æ²¿ç”¨ **åŒä¸€æ¨¡å‹ gte-small**ï¼Œä½†ä¼˜å…ˆè¿”å›åŒè¯­ç»“æœã€‚
        - ç«™ç‚¹å¯¼èˆªæä¾›**è¯­è¨€åˆ‡æ¢**ï¼Œå¯åœ¨åŒ slug é—´äº’è·³ï¼›è‹¥ç¼ºå¤±å¯¹åº”è‹±æ–‡ï¼Œé€€å›è‹±æ–‡é¦–é¡µã€‚

  - type: markdown
    attributes:
      value: |
        ## ğŸ§© å¾…åŠä»»åŠ¡

        ### 1) ç›®å½•ä¸ç”Ÿæˆ
        - æ‰©å±• `pagegen.mjs`ï¼š
          - åŒæ—¶éå† `docs/content/**` ä¸ `docs/content.en/**`
          - äº§å‡º `/en/` çš„èšåˆé¡µï¼ˆåˆ†ç±»/å½’æ¡£/æ ‡ç­¾é¡µï¼‰
          - ç”Ÿæˆå¤šè¯­ sitemapï¼š
            - `docs/public/sitemap.xml`ï¼ˆzhï¼‰
            - `docs/public/sitemap.en.xml`ï¼ˆenï¼‰
          - ï¼ˆå¯é€‰ï¼‰RSS æŒ‰è¯­è¨€å„ä¸€ä»½ï¼š
            - `rss.xml`ï¼ˆzhï¼‰ï¼Œ`rss.en.xml`ï¼ˆenï¼‰
        - BASE å­è·¯å¾„å…¼å®¹ï¼šæ‰€æœ‰é“¾æ¥ä¸é™æ€èµ„æºéœ€ä½¿ç”¨ç›¸å¯¹è·¯å¾„æˆ– `withBase()`ã€‚

        ### 2) è¯­è¨€åˆ‡æ¢
        - æ–°å¢ `docs/.vitepress/i18n.json`ï¼šå¯¼èˆªä¸ç»„ä»¶æ–‡æ¡ˆæ˜ å°„ï¼ˆzh/enï¼‰
        - ä¿®æ”¹ `Layout.vue`ï¼š
          - åŠ è¯­è¨€åˆ‡æ¢ UIï¼ˆæŒ‰é’®æˆ–ä¸‹æ‹‰ï¼‰
          - è§„åˆ™ï¼šè‹¥å½“å‰æ–‡æ¡£å­˜åœ¨å¯¹åº”è‹±æ–‡ **slug**ï¼Œè·³è½¬ `/en/<slug>`ï¼›å¦åˆ™è·³è½¬ `/en/` é¦–é¡µ
          - åå‘ä» `/en/...` åˆ‡å› `/...` åŒ slug
        - å¤´éƒ¨/é¡µè„šã€æœç´¢å ä½ç¬¦ç­‰æ–‡æœ¬è¯»å– i18n æ˜ å°„

        ### 3) æœç´¢
        - **Pagefind**ï¼š
          - äº§å‡º zh ä¸ en ä¸¤å¥—ç´¢å¼•ï¼ˆç›®å½•éš”ç¦»ï¼Œå¦‚ `/pagefind/zh/**` ä¸ `/pagefind/en/**`ï¼‰
          - `SearchBox` æ ¹æ®å½“å‰è·¯å¾„å‰ç¼€æˆ–è¯­è¨€çŠ¶æ€é€‰æ‹©ç´¢å¼•åŸŸ
        - **è¯­ä¹‰æ£€ç´¢**ï¼š
          - æ²¿ç”¨ `gte-small`ï¼ˆTransformers.jsï¼‰ï¼Œ**åŒè¯­ç»“æœä¼˜å…ˆ**ï¼ˆæ‰“åˆ†åŠ æƒæˆ–å…ˆè¿‡æ»¤åå›é€€ï¼‰
          - å½“è·¨è¯­æŸ¥è¯¢æ—¶ï¼Œä¿ç•™ RRF/MMR èåˆï¼Œä½†ä¼˜å…ˆå±•ç¤ºä¸å½“å‰è¯­è¨€ä¸€è‡´çš„å€™é€‰

        ### 4) CI
        - å¢åŠ è‹±æ–‡ä¾§æ­»é“¾æ£€æŸ¥ï¼š`docs/content.en/**`
        - æ„å»ºåç”Ÿæˆå¹¶å‘å¸ƒä¸¤ä»½ sitemapï¼ˆ`sitemap.xml`ã€`sitemap.en.xml`ï¼‰
        - ï¼ˆå¯é€‰ï¼‰åˆ†åˆ«å¯¹ zh/en è¿è¡Œ Lighthouse smokeï¼ˆéå¼ºåˆ¶ï¼‰

  - type: checkboxes
    id: acceptance
    attributes:
      label: âœ… éªŒæ”¶æ ‡å‡†
      options:
        - label: `/` ä¸ `/en/` è·¯ç”±å‡å¯è®¿é—®ï¼Œè¯­è¨€åˆ‡æ¢åœ¨åŒ slug é—´äº’è·³ï¼Œç¼ºå¤±æ˜ å°„æ—¶è·³è½¬è‹±æ–‡é¦–é¡µ
          required: true
        - label: Pagefind åœ¨ä¸¤ç§è¯­è¨€ä¸‹å¯ç‹¬ç«‹æ£€ç´¢ï¼›è¯­ä¹‰æ£€ç´¢åœ¨å½“å‰è¯­è¨€ä¸‹ç»“æœä¼˜å…ˆ
          required: true
        - label: ç”Ÿæˆä¸¤ä»½ sitemapï¼ˆzh / enï¼‰ï¼Œå¹¶é€šè¿‡æ­»é“¾æ£€æŸ¥ï¼ˆåŒ…å«è‹±æ–‡ä¾§ï¼‰
          required: true
        - label: ä¸å½±å“æ—¢æœ‰ä¸­æ–‡ URL ä¸æ„å»ºæµç¨‹
          required: true

  - type: textarea
    id: structure
    attributes:
      label: ğŸ§¾ ç›®å½•ä¸è·¯ç”±è®¾è®¡
      description: ç²˜è´´ `content` / `content.en` çš„ç¤ºä¾‹å±‚çº§ä¸ slug å¯¹åº”å…³ç³»ï¼›è¯´æ˜èšåˆé¡µä¸ sitemap äº§å‡ºä½ç½®
      placeholder: |
        docs/
          content/{cat}/{post}/index.md
          content.en/{cat-en}/{post-en}/index.md
        /en/{cat-en}/{post-en}/

  - type: textarea
    id: search-notes
    attributes:
      label: ğŸ” æœç´¢ä¸è¯­ä¹‰èåˆè¯´æ˜
      description: æè¿° zh/en Pagefind ç´¢å¼•çš„é€‰æ‹©é€»è¾‘ä¸è¯­ä¹‰ä¾§â€œåŒè¯­ä¼˜å…ˆâ€çš„å®ç°æ–¹å¼
      placeholder: |
        - ç´¢å¼•è·¯å¾„ï¼š/pagefind/zh/** ä¸ /pagefind/en/**
        - è¯­è¨€åˆ¤æ–­ï¼šåŸºäº pathname.startsWith('/en/')
        - èåˆï¼šåŒè¯­åŠ æƒ + RRFï¼›ä¸è¶³æ—¶å›é€€è·¨è¯­è¡¥å…¨

  - type: textarea
    id: logs
    attributes:
      label: ğŸ§ª éªŒè¯ä¸æ—¥å¿—
      description: è´´å‡ºæœ¬åœ°/CI æ„å»ºæ—¥å¿—ç‰‡æ®µï¼ˆpagegen åŒç›®å½•æ‰«æã€ä¸¤ä»½ sitemapã€è‹±æ–‡æ­»é“¾æ£€æŸ¥é€šè¿‡ï¼‰ï¼Œä»¥åŠæœç´¢åœ¨ zh/en ä¸¤ä¾§çš„æŸ¥è¯¢ç¤ºä¾‹
      placeholder: |
        [pagegen] zh: 86 docs, en: 24 docs
        [pagefind] built zh/en indexes
        [links] zh OK (0 errors), en OK (0 errors)
        [sitemap] sitemap.xml / sitemap.en.xml written

  - type: markdown
    attributes:
      value: |
        ## âš™ï¸ å®æ–½æç¤º
        - slug æ˜ å°„å»ºè®®åœ¨ frontmatter ä¸­å¢åŠ  `slug_en`ï¼›ç¼ºçœæ—¶å¯æ ¹æ®æ ‡é¢˜è‡ªåŠ¨è½¬ slugã€‚
        - i18n.json ä¸­çš„å¯¼èˆªé¡¹éœ€ä¸è·¯ç”±å‰ç¼€ä¸€è‡´ï¼Œé¿å…ç¡¬ç¼–ç è·¯å¾„ã€‚
        - æœç´¢å ä½ç¬¦/ç©ºæ€æç¤ºç­‰ UI æ–‡æ¡ˆä» i18n è¯»å–ï¼Œé¿å…åˆ†æ”¯æ•£è½ã€‚
        - è¯­ä¹‰åŒè¯­ä¼˜å…ˆå¯é€šè¿‡â€œè¯­è¨€æ ‡ç­¾åŒ¹é… + åˆ†æ•°åŠ æƒâ€æˆ–â€œå…ˆåŒè¯­æ£€ç´¢ã€æ— ç»“æœå†è·¨è¯­å›é€€â€å®ç°ã€‚

  - type: markdown
    attributes:
      value: |
        ## ğŸ” å›æ»šç­–ç•¥
        - å…³é—­ `.en` ç®¡çº¿ï¼ˆpagegen/ç´¢å¼•/æ­»é“¾ï¼‰ï¼›éšè—è¯­è¨€åˆ‡æ¢å…¥å£ã€‚
        - ä¸­æ–‡ä¾§è·¯å¾„ä¸ç«™ç‚¹è¡Œä¸ºä¸å—å½±å“ï¼Œæœç´¢ä»æŒ‰å•è¯­æ¨¡å¼è¿è¡Œã€‚
