name: "PR-D æ€§èƒ½ä¸ä½“æ£€"
description: "ä¸º Ling-Atlas é¡¹ç›®æ·»åŠ æ„å»ºä½“ç§¯é¢„ç®—ä¸ Lighthouse å®ˆé—¨æœºåˆ¶"
title: "[PR-D] æ€§èƒ½ä¸ä½“æ£€"
labels: ["performance", "CI", "automation"]
body:
  - type: markdown
    attributes:
      value: |
        ## ğŸ¯ ç›®æ ‡
        ç»™ç«™ç‚¹è®¾ç½®ä½“ç§¯é¢„ç®—ä¸ Lighthouse å®ˆé—¨ï¼š
        - è¶…é™å³ CI failï¼›
        - æœ¬åœ°å¼€å‘ä¸é¢„è§ˆä¸å—å½±å“ã€‚

  - type: markdown
    attributes:
      value: |
        ## ğŸ§© ä»»åŠ¡

        ### 1ï¸âƒ£ äº§ç‰©ä½“ç§¯é¢„ç®—è„šæœ¬
        **æ–‡ä»¶**ï¼š`.codex/budget.mjs`  
        **é…ç½®**ï¼š`scripts/budget.config.json`  
        - è¯»å– `docs/.vitepress/dist` ç›®å½•  
        - è®¡ç®—æŒ‡æ ‡ï¼š
          - æ€»ä½“ç§¯ï¼ˆMBï¼‰
          - æœ€å¤§ JS chunkï¼ˆKBï¼‰
          - æœ€å¤§ CSSï¼ˆKBï¼‰
        - é»˜è®¤é˜ˆå€¼ï¼š
          - æ€» â‰¤ **5MB**
          - JS â‰¤ **150KB**
          - CSS â‰¤ **100KB**
        - é˜ˆå€¼å¯é€šè¿‡ **ç¯å¢ƒå˜é‡** è¦†ç›–  
        - è¶…é™æ—¶ `process.exit(1)`  
        - æ‰“å° Top 10 æœ€å¤§æ–‡ä»¶æ˜ç»†  

        ### 2ï¸âƒ£ é›†æˆ Lighthouse CI
        - å¼€å‘ä¾èµ–ï¼š`@lhci/cli`
        - æ–°å¢é…ç½®ï¼š`.lighthouserc.json`
        - è¿è¡Œå‘½ä»¤ï¼š
          ```bash
          npx lhci autorun \
            --collect.staticDistDir=docs/.vitepress/dist \
            --upload.target=temporary-public-storage
          ```
        - æ£€æŸ¥åˆ†é¡¹ï¼š
          - Performance â‰¥ 90
          - Accessibility â‰¥ 90
          - Best Practices â‰¥ 90  
        - ä½äºé˜ˆå€¼æ—¶ `exit(1)` å¹¶åœ¨æ—¥å¿—è¾“å‡ºåˆ†æ•°ä¸å…³é”®å»ºè®®æ‘˜è¦

        ### 3ï¸âƒ£ CI å·¥ä½œæµ
        åœ¨æ„å»ºæµç¨‹ï¼ˆVitePress build + Pagefind + Embeddingsï¼‰å®Œæˆåï¼Œä¾æ¬¡æ‰§è¡Œï¼š
        ```bash
        node .codex/budget.mjs
        npx lhci autorun ...
        ```

        ### 4ï¸âƒ£ æ–‡æ¡£æ›´æ–°
        - åœ¨ `AGENTS.md` å¢è¡¥ç« èŠ‚ **â€œæ€§èƒ½é¢„ç®—ä¸ä½“æ£€â€**
        - åŒ…å«ï¼š
          - é˜ˆå€¼è¯´æ˜ä¸è°ƒå‚æ–¹æ³•
          - å¤±è´¥ç¤ºä¾‹ä¸å›æ»šç­–ç•¥ï¼ˆå¦‚ä½•æ”¾å®½é˜ˆå€¼æˆ–æš‚æ—¶æ³¨é‡Šï¼‰

  - type: markdown
    attributes:
      value: |
        ## âœ… éªŒæ”¶æ ‡å‡†
        - CI è¾“å‡ºé¢„ç®—æŠ¥å‘Šä¸ Lighthouse åˆ†æ•°
        - é˜ˆå€¼å¯é€šè¿‡ç¯å¢ƒå˜é‡è°ƒæ•´
        - è¶…é™æ—¶ CI failï¼Œä¿®å¤åé€šè¿‡
        - ä¸å½±å“æœ¬åœ° `dev` / `preview`

  - type: markdown
    attributes:
      value: |
        ## ğŸ” å›æ»šç­–ç•¥
        - ä¸´æ—¶æ”¾å®½é˜ˆå€¼ï¼ˆé€šè¿‡ envï¼‰
        - æˆ–æ³¨é‡Š `.codex/budget.mjs` ä¸ LHCI æ­¥éª¤ï¼Œä¸å½±å“ä¸»åŠŸèƒ½