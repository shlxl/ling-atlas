{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Ling Atlas Navigation Configuration",
  "type": "object",
  "additionalProperties": false,
  "required": ["aggregates", "sections"],
  "properties": {
    "$schema": { "type": "string" },
    "aggregates": {
      "type": "object",
      "additionalProperties": false,
      "minProperties": 1,
      "patternProperties": {
        "^[a-zA-Z0-9_-]+$": {
          "type": "object",
          "additionalProperties": false,
          "required": ["type", "labelKey", "manifestKey"],
          "properties": {
            "type": { "type": "string", "enum": ["archive", "category", "series", "tag"] },
            "labelKey": { "type": "string", "minLength": 1 },
            "manifestKey": { "type": "string", "minLength": 1 },
            "sort": { "type": "string", "enum": ["asc", "desc"], "default": "asc" },
            "fallback": { "type": "boolean", "default": false }
          }
        }
      }
    },
    "sections": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": ["key", "titleKey"],
        "properties": {
          "key": { "type": "string", "minLength": 1 },
          "titleKey": { "type": "string", "minLength": 1 },
          "kind": {
            "type": "string",
            "enum": ["aggregate", "link", "group"],
            "default": "link"
          },
          "aggregateKey": { "type": "string" },
          "link": { "type": "string" },
          "items": {
            "type": "array",
            "items": { "$ref": "#/definitions/navItem" }
          }
        },
        "allOf": [
          {
            "if": { "properties": { "kind": { "const": "aggregate" } } },
            "then": { "required": ["aggregateKey"] }
          },
          {
            "if": { "properties": { "kind": { "const": "link" } } },
            "then": { "required": ["link"] }
          },
          {
            "if": { "properties": { "kind": { "const": "group" } } },
            "then": { "required": ["items"] }
          }
        ]
      }
    },
    "links": {
      "type": "object",
      "additionalProperties": {
        "type": "object",
        "additionalProperties": false,
        "required": ["href"],
        "properties": {
          "href": { "type": "string", "minLength": 1 },
          "labelKey": { "type": "string" }
        }
      }
    }
  },
  "definitions": {
    "navItem": {
      "type": "object",
      "additionalProperties": false,
      "required": ["key"],
      "properties": {
        "key": { "type": "string", "minLength": 1 },
        "link": { "type": "string", "minLength": 1 },
        "labelKey": { "type": "string", "minLength": 1 }
      }
    }
  }
}
